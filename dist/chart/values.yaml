# [MANAGER]: Manager Deployment Configurations
controllerManager:
  # Optional: image pull secrets for private registries.
  # Example:
  # imagePullSecrets:
  #   - name: my-registry-secret
  imagePullSecrets: []
  replicas: 1
  container:
    image:
      repository: ghcr.io/duchaineo1/pihole-operator
      tag: v1.0.27
    imagePullPolicy: IfNotPresent
    args:
      - "--leader-elect"
      - "--metrics-bind-address=:8443"
      - "--health-probe-bind-address=:8081"
    resources:
      limits:
        cpu: 500m
        memory: 128Mi
      requests:
        cpu: 10m
        memory: 64Mi
    livenessProbe:
      initialDelaySeconds: 15
      periodSeconds: 20
      httpGet:
        path: /healthz
        port: 8081
    readinessProbe:
      initialDelaySeconds: 5
      periodSeconds: 10
      httpGet:
        path: /readyz
        port: 8081
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - "ALL"
  securityContext:
    runAsNonRoot: true
    seccompProfile:
      type: RuntimeDefault
  terminationGracePeriodSeconds: 10
  serviceAccountName: pihole-operator-controller-manager

# [RBAC]: To enable RBAC (Permissions) configurations
rbac:
  enable: true

# [CRDs]: To enable the CRDs
crd:
  # This option determines whether the CRDs are included
  # in the installation process.
  enable: true

  # Enabling this option adds the "helm.sh/resource-policy": keep
  # annotation to the CRD, ensuring it remains installed even when
  # the Helm release is uninstalled.
  # NOTE: Removing the CRDs will also remove all cert-manager CR(s)
  # (Certificates, Issuers, ...) due to garbage collection.
  keep: true

# [METRICS]: Set to true to generate manifests for exporting metrics.
# To disable metrics export set false, and ensure that the
# ControllerManager argument "--metrics-bind-address=:8443" is removed.
metrics:
  enable: true

# [PROMETHEUS]: To enable a ServiceMonitor to export metrics to Prometheus set true
prometheus:
  enable: false

# [CERT-MANAGER]: To enable cert-manager injection to webhooks set true
certmanager:
  enable: false

# [NETWORK POLICIES]: To enable NetworkPolicies set true
networkPolicy:
  enable: false

# [PIHOLE]: Optionally deploy a Pihole CR alongside the operator.
# Set enable: true to create a Pihole instance as part of the Helm release.
pihole:
  enable: false
  name: pihole
  size: 1
  # adminPassword: "changeme"          # Inline password (a random one is generated if omitted)
  # adminPasswordSecretRef:            # Or reference an existing Secret
  #   name: my-pihole-secret
  #   key: password
  timezone: "UTC"
  storageSize: "1Gi"
  # storageClass: ""                   # Omit to use the default StorageClass

  # DNS service exposure.
  # Use "LoadBalancer" to expose DNS externally (requires MetalLB or a cloud LB).
  # Use "NodePort" to expose on a high port on every node.
  # Use "ClusterIP" for cluster-internal only.
  dnsServiceType: "LoadBalancer"
  # dnsLoadBalancerIP: "192.168.1.53"  # Optional: pin to a specific IP

  webServiceType: "ClusterIP"
  # webLoadBalancerIP: ""
